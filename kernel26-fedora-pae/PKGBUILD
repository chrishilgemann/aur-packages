# Maintainer: Phillip Smith <fukawi2@NOSPAM.gmail.com>

pkgname=kernel26-fedora-pae
pkgver=2.6.31
pkgrel=40.fc12
url="http://www.kernel.org/"
pkgdesc="The Linux Kernel and modules, compiled by Fedora. PAE supported. (Memory >= 4GB)"
arch=('i686' 'x86_64')
license=('GPL2')
depends=('coreutils' 'module-init-tools' 'mkinitcpio>=0.5.15')
makedepends=('rpmextract')
backup=('etc/mkinitcpio.d/kernel26.preset')
provides=("kernel26=$pkgver" "kernel26-fedora-pae=$pkgver")
conflicts=('kernel24' 'kernel24-scsi' 'kernel26-scsi' 'kernel26' 'kernel26-fedora')
install="kernel26-fedora.install"
source=("http://kojipkgs.fedoraproject.org/packages/kernel/${pkgver}/${pkgrel}/${CARCH}/kernel-PAE-${pkgver}-${pkgrel}.${CARCH}.rpm"
        "kernel26-fedora.preset")

build() {
  msg "Nothing to compile for $pkgname"
}

package() {
	cd $pkgdir
  
	rpmextract.sh $srcdir/kernel-PAE-${pkgver}-${pkgrel}.${CARCH}.rpm
  
	rm -rf $pkgdir/etc/ld.so.conf.d || return 1
	rm -rf $pkgdir/usr || return 1
  
	msg "Generating kernel26-fedora.kver..."
	_kernver=${pkgver}-${pkgrel}.${CARCH}.PAE
	cat > $pkgdir/etc/mkinitcpio.d/kernel26-fedora.kver <<EOT
# DO NOT EDIT THIS FILE
ALL_kver='$_kernver'"
EOT
	
  # Install mkinitcpio files
	install -D -m644 $srcdir/kernel26-fedora.preset $pkgdir/etc/mkinitcpio.d/kernel26-fedora.preset || return 1
}

# vim:set ts=2 sw=2 et:
md5sums=('cfc0310d8afbfdc42074029a2d6ae565'
         'c8f559ad29f3bce277ed054d85878c40')
