# Maintainer: Phillip Smith <fukawi2@NO-SPAM.gmail.com>
# Maintainer: Matias Korhonen <webadmin@draco-vulgaris.net>
# Contributor: Dylon Edwards <deltaecho@archlinux.us>
pkgname=backintime
pkgver=0.9.26
pkgrel=4
pkgdesc="Back In Time is a simple backup system for Linux inspired from the Flyback project and TimeVault."
arch=('i686' 'x86_64')
url="http://backintime.le-web.org/"
license=('GPL')
depends=( 'python' 'rsync' 'dcron' )
source=(http://backintime.le-web.org/download/${pkgname}/${pkgname}-${pkgver}_src.tar.gz)
md5sums=('8a53d1f757ccfa439754f4a8b9cb3e49')

# Build a custom array of depends based on what DE is installed
if [ `which gnome-session 2> /dev/null` ]; then
  depends=( ${depends[@]} 'pygtk' 'python-notify' 'gnome-python' 'meld' )
  _type=( ${_type[@]} gnome )
fi

if [ `which kdeinit4 2> /dev/null` ]; then
  depends=( ${depends[@]} 'xorg-utils' 'pyqt' 'kdebindings-python')
  _type=( ${_type[@]} kde4 )
fi

if [ ${#_type[@]} == 0 ]; then
  return 1
fi

build() {
  msg "Compiling COMMON components..."
  cd ${srcdir}/${pkgname}-${pkgver}/common
  
  ./configure || return 1
  
  make || return 1
  
  for t in ${_type[@]}; do
    msg "Building the "${t}" UI"
    cd ${srcdir}/${pkgname}-${pkgver}/${t}
    
    ./configure || return 1
    
    make || return 1
  done
}

package() {
  msg "Packaging COMMON components..."
  cd ${srcdir}/${pkgname}-${pkgver}/common
  make DESTDIR=${pkgdir} install
  
  for t in ${_type[@]}; do
    msg "Packaging the "${t}" UI"
    cd ${srcdir}/${pkgname}-${pkgver}/${t}
    
    make DESTDIR=${pkgdir} install || return 1
  done
}

# vim:set ts=2 sw=2 et:
